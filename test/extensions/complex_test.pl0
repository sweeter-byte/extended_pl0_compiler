program complextest;
const Max := 5;
var 
    p: pointer,
    sum: integer,
    i: integer;
    
procedure bubbleSort(arr, n);
var i, j, temp: integer;
begin
    i := 0;
    while i < n - 1 do
    begin
        j := 0;
        while j < n - i - 1 do
        begin
            if arr[j] > arr[j + 1] then
            begin
                temp := arr[j];
                arr[j] := arr[j + 1];
                arr[j + 1] := temp;
            end;
            j := j + 1;
        end;
        i := i + 1;
    end;
end;

begin
    { 1. Allocate Array on Heap using Pointer }
    new(p, Max);
    
    { 2. Fill Array }
    p[0] := 10;
    p[1] := 5;
    p[2] := 8;
    p[3] := 2;
    p[4] := 7;
    
    write(8888); { Checkpoint 1 }
    
    { 3. Sort Array }
    call bubbleSort(p, Max);
    
    { 4. Verify Sorted }
    i := 0;
    while i < Max do
    begin
        write(p[i]);
        i := i + 1;
    end;
    
    { 5. Access Violation Check (Should Crash if uncommented or if logic is wrong) }
    { write(p[Max + 1]); }
    
    { 6. Delete Array }
    delete(p);
    
    write(9999); { Success }
end
